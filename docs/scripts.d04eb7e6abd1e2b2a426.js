class particleJS{constructor(t){return this.ele=document.getElementById(t.element),this.src=t.imagePath,this.cropStartPointX=t.cropStartPointX,this.cropStartPointY=t.cropStartPointY,this.cropX=t.cropX,this.cropY=t.cropY,this.startingPointX=t.startingPointX,this.startingPointY=t.startingPointY,this.destinationX=t.destinationX,this.destinationY=t.destinationY,this.duration=t.duration,this.pointOffsetEnable=t.pointOffsetEnable,this.pointOffsetLevel=t.pointOffsetLevel,this.timeOffsetLevel=t.timeOffsetLevel,this.spacingEnable=t.spacingEnable,this.spacingLevel=t.spacingLevel,this}render(){let t=null;this.ele.getContext&&(t=this.ele.getContext("2d"));let e=new Image,i=this;e.onload=function(){let a=e.width;i.ele.height=e.height,i.ele.width=a,t.drawImage(e,i.cropStartPointX,i.cropStartPointY,i.cropX,i.cropY,0,0,i.cropX,i.cropY);let n=null,o=0,r=[],s=t.getImageData(0,0,i.cropX,i.cropY);function l(t,e,i,a){return 0==t?e:t==a?e+i:(t/=a/2)<1?i/2*Math.pow(2,10*(t-1))+e:i/2*(2-Math.pow(2,-10*--t))+e}!function(){if(i.spacingEnable)for(let t=1;t<=i.cropY;t++)for(let e=1;e<=i.cropX;e++)if(t%i.spacingLevel==0&&e%i.spacingLevel==0){let a,n=4*((t-1)*i.cropX+e-1),o="rgba("+s.data[n]+", "+s.data[n+1]+", "+s.data[n+2]+", "+s.data[n+3]+")";a=i.pointOffsetEnable?(Math.random()-.5)*i.pointOffsetLevel:0;let l=(Math.random()-.5)*i.timeOffsetLevel;r.push({x:i.destinationX+e+a,y:i.destinationY+t+a,style:o,delay:0+l})}else{let a=4*((t-1)*i.cropX+e-1);s.data[a]=0,s.data[a+1]=0,s.data[a+2]=0,s.data[a+3]=0}else for(let t=1;t<=i.cropY;t++)for(let e=1;e<=i.cropX;e++){let a,n=4*((t-1)*i.cropX+e-1),o="rgba("+s.data[n]+", "+s.data[n+1]+", "+s.data[n+2]+", "+s.data[n+3]+")";a=i.pointOffsetEnable?(Math.random()-.5)*i.pointOffsetLevel:0;let l=(Math.random()-.5)*i.timeOffsetLevel;r.push({x:i.destinationX+e+a,y:i.destinationY+t+a,style:o,delay:0+l})}}(),requestAnimationFrame((function a(){t.clearRect(0,0,i.ele.width,i.ele.height);for(let e=0,s=r.length;e<s;e++)if(o<=i.duration){if(n=r[e],n.delay>o)continue;{t.fillStyle=n.style;let e=l(o,i.startingPointX,n.x-i.startingPointX,i.duration+n.delay),a=l(o,i.startingPointY,n.y-i.startingPointY,i.duration+n.delay);t.fillRect(e,a,1,1)}}o>i.duration?t.drawImage(e,i.cropStartPointX,i.cropStartPointY,i.cropX,i.cropY,0,0,i.cropX,i.cropY):(o++,requestAnimationFrame(a))}))},e.crossOrigin="anonymous",e.src=this.src}}export default particleJS;